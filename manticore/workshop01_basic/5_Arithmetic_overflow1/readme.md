# about

my_token.py uses manticore to find for an attacker to generate tokens during a transfer on Token (my_token.sol)

Initialization

    Create one user account
    Create the contract account

Exploration

    Call balances on the user account
    Call transfer with symbolic destination and value
    Call balances on the user account

Property

    Check if the user can have more token after the transfer than before.



## run

```
(manticore_native) (REDF)vlad@vladis:play/5_Arithmetic_overflow1 ‹main*›$ python my_token.py            
2022-06-09 17:47:59,174: [350497] m.c.plugin:WARNING: Caught will_solve in state None, but failed to capture its initialization
Bug found! see /data/redef/research/manticore/play/5_Arithmetic_overflow1/mcore_0cxconk2
```

```
 mcore_0cxconk2/BugFound_00000000.tx 
 =====================================
Transactions No. 0
Type: CREATE (0)
From: normal0(0x8fc9fd25b0f6ec8909eeb4d77cdc4865260e3110) 
To: contract0(0x23aa404e28e260021b96718f9f6d5c8b1d664f2a) 
Value: 0 
Gas used: 3000000 
Data: 0x608060405234801561001057600080fd5b5060646000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061024e806100646000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c806327e235e31461003b578063a9059cbb14610093575b600080fd5b61007d6004803603602081101561005157600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506100e1565b6040518082815260200191505060405180910390f35b6100df600480360360408110156100a957600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291905050506100f9565b005b60006020528060005260406000206000915090505481565b6000808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541061021557806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540392505081905550806000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b505056fea265627a7a72315820a9a8af85f06e66c8498a1b62e0bf4d2db0bd8cb9383a92c965128360abf3b83764736f6c634300050c0032 
Return_data: 0x608060405234801561001057600080fd5b50600436106100365760003560e01c806327e235e31461003b578063a9059cbb14610093575b600080fd5b61007d6004803603602081101561005157600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506100e1565b6040518082815260200191505060405180910390f35b6100df600480360360408110156100a957600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291905050506100f9565b005b60006020528060005260406000206000915090505481565b6000808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541061021557806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540392505081905550806000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b505056fea265627a7a72315820a9a8af85f06e66c8498a1b62e0bf4d2db0bd8cb9383a92c965128360abf3b83764736f6c634300050c0032  (*)
Function call:
Constructor() -> RETURN 


Transactions No. 1
Type: CALL (0)
From: normal0(0x8fc9fd25b0f6ec8909eeb4d77cdc4865260e3110) 
To: contract0(0x23aa404e28e260021b96718f9f6d5c8b1d664f2a) 
Value: 0 
Gas used: 210000 
Data: 0x27e235e30000000000000000000000008fc9fd25b0f6ec8909eeb4d77cdc4865260e3110 
Return_data: 0x0000000000000000000000000000000000000000000000000000000000000064 (d) (*)

Function call:
balances(820890182246728248425256428799945426486371954960) -> RETURN 
return: 100 (*)


Transactions No. 2
Type: CALL (0)
From: normal0(0x8fc9fd25b0f6ec8909eeb4d77cdc4865260e3110) 
To: contract0(0x23aa404e28e260021b96718f9f6d5c8b1d664f2a) 
Value: 0 
Gas used: 210000 
Data: 0xa9059cbb0000000000000000000000000000000000000000000000000000000000000000d78618acecb41b9d8abccb53a5f24e7de8b899e80fc6811c8c5c140f99d799c0 (*)
Return_data: 0x () 

Function call:
transfer(0,97484190256033519638962750254315192109305318780866883701504553576794194155968) -> STOP (*)


Transactions No. 3
Type: CALL (0)
From: normal0(0x8fc9fd25b0f6ec8909eeb4d77cdc4865260e3110) 
To: contract0(0x23aa404e28e260021b96718f9f6d5c8b1d664f2a) 
Value: 0 
Gas used: 210000 
Data: 0x27e235e30000000000000000000000008fc9fd25b0f6ec8909eeb4d77cdc4865260e3110 
Return_data: 0x4ce8211ff66d2210a237f37c7df3ae168e29d878c2ec5d4f9cd79bda9ceab584 (L!m"7|})x]O) (*)

Function call:
balances(820890182246728248425256428799945426486371954960) -> RETURN 
return: 34785913630696339941067571034825547563856663768594226249959810447429117588868 (*)




(*) Example solution given. Value is symbolic and may take other values
```
